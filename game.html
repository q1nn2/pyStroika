<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–°—Ç—Ä–æ–π–∫–∞ ‚Äî –ö—Ä–∞–Ω</title>
  <link rel="stylesheet" href="css/main.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css">
</head>
<body class="page-game">

  <header class="header">
    <a href="index.html" class="btn btn-back">‚Üê –ù–∞–∑–∞–¥</a>
    <h1 class="level-title" id="levelTitle">–ó–∞–¥–∞–Ω–∏–µ</h1>
    <a href="progress.html" class="btn btn-secondary">–ü—Ä–æ–≥—Ä–µ—Å—Å</a>
  </header>

  <div class="game-layout">

    <!-- LEFT: Isometric 3D world -->
    <div class="game-panel-left">
      <div class="canvas-header">
        <span class="canvas-title">üèó –ò–≥—Ä–æ–≤–æ–π –º–∏—Ä</span>
        <span class="carried-info" id="carriedInfo">–ü—É—Å—Ç–æ</span>
        <span class="dir-info" id="dirInfo"></span>
      </div>
      <div id="canvasWrap" class="canvas-wrap">
        <canvas id="gameCanvas"></canvas>
        <!-- Camera controls overlay -->
        <div class="camera-controls">
          <button type="button" class="cam-btn" id="btnZoomIn"  title="–ü—Ä–∏–±–ª–∏–∑–∏—Ç—å">Ôºã</button>
          <button type="button" class="cam-btn" id="btnZoomOut" title="–û—Ç–¥–∞–ª–∏—Ç—å">Ôºç</button>
          <button type="button" class="cam-btn" id="btnCameraReset" title="–°–±—Ä–æ—Å–∏—Ç—å –≤–∏–¥">‚åÇ</button>
        </div>
        <div class="camera-hint" id="cameraHint">
          üñ± –¢—è–Ω–∏ –¥–ª—è –ø–æ–≤–æ—Ä–æ—Ç–∞ ¬∑ –ü–ö–ú –¥–ª—è –ø–∞–Ω–æ—Ä–∞–º—ã ¬∑ –°–∫—Ä–æ–ª–ª –¥–ª—è –∑—É–º–∞
        </div>
      </div>
      <div class="canvas-legend">
        <span class="legend-item"><span class="swatch swatch-goal"></span>–¶–µ–ª—å</span>
        <span class="legend-item"><span class="swatch swatch-brick"></span>–ö–∏—Ä–ø–∏—á</span>
        <span class="legend-item"><span class="swatch swatch-slab"></span>–ü–ª–∏—Ç–∞</span>
        <span class="legend-item"><span class="swatch swatch-ground"></span>–ó–µ–º–ª—è</span>
      </div>
    </div>

    <!-- RIGHT: Theory + Task + Editor -->
    <div class="game-panel-right">

      <section class="theory-section" id="theorySection">
        <div class="theory-card">
          <button type="button" class="btn-theory-toggle" id="btnTheoryToggle">üìñ –¢–µ–æ—Ä–∏—è (–Ω–∞–∂–º–∏, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å)</button>
          <div class="theory-content" id="theoryContent" hidden>
            <p id="theoryText"></p>
          </div>
        </div>
      </section>

      <section class="task-section">
        <div class="task-card">
          <h2><span id="levelIcon"></span> –ó–∞–¥–∞–Ω–∏–µ</h2>
          <p class="task-description" id="taskDescription"></p>
          <div class="task-topic">–¢–µ–º–∞: <span id="taskTopic"></span></div>
          <details class="task-example-wrap">
            <summary>–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞</summary>
            <pre class="task-example" id="taskExample"></pre>
          </details>
          <button type="button" class="btn btn-hint" id="btnHint">üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞</button>
          <div class="hint-output" id="hintOutput"></div>
        </div>
      </section>

      <section class="commands-ref">
        <details>
          <summary>üìã –°–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ –∫—Ä–∞–Ω–∞</summary>
          <ul class="commands-list">
            <li><code>move()</code> ‚Äî –¥–≤–∏–≥–∞—Ç—å—Å—è –≤–ø–µ—Ä—ë–¥ –Ω–∞ 1 —à–∞–≥</li>
            <li><code>turn_left()</code> ‚Äî –ø–æ–≤–µ—Ä–Ω—É—Ç—å –Ω–∞–ª–µ–≤–æ –Ω–∞ 90¬∞</li>
            <li><code>turn_right()</code> ‚Äî –ø–æ–≤–µ—Ä–Ω—É—Ç—å –Ω–∞–ø—Ä–∞–≤–æ –Ω–∞ 90¬∞</li>
            <li><code>lift()</code> ‚Äî –ø–æ–¥–Ω—è—Ç—å –±–ª–æ–∫ –≤–ø–µ—Ä–µ–¥–∏</li>
            <li><code>place()</code> ‚Äî –ø–æ–ª–æ–∂–∏—Ç—å –Ω–µ—Å–æ–º—ã–π –±–ª–æ–∫ –≤–ø–µ—Ä–µ–¥–∏</li>
            <li><code>place_block('brick')</code> ‚Äî –ø–æ–ª–æ–∂–∏—Ç—å –∫–∏—Ä–ø–∏—á (brick/slab/wood/stone)</li>
            <li><code>dig()</code> ‚Äî —É–±—Ä–∞—Ç—å –±–ª–æ–∫ –≤–ø–µ—Ä–µ–¥–∏</li>
            <li><code>look()</code> ‚Äî —á—Ç–æ –≤–ø–µ—Ä–µ–¥–∏? (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä–æ–∫—É)</li>
          </ul>
        </details>
      </section>

      <section class="editor-section">
        <div class="editor-toolbar">
          <button type="button" class="btn btn-primary" id="btnRun">‚ñ∂ –ó–∞–ø—É—Å—Ç–∏—Ç—å</button>
          <button type="button" class="btn btn-success" id="btnCheck">‚úì –ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
          <button type="button" class="btn btn-reset" id="btnReset">‚Ü∫ –°–±—Ä–æ—Å</button>
        </div>
        <div id="editorWrap" class="editor-wrap"></div>
        <div class="output-wrap">
          <pre id="output" class="output">–ù–∞–ø–∏—à–∏ –∫–æ–¥ –∏ –Ω–∞–∂–º–∏ ¬´–ó–∞–ø—É—Å—Ç–∏—Ç—å¬ª</pre>
        </div>
      </section>

    </div>
  </div>

  <!-- Success modal -->
  <div class="modal" id="successModal" hidden style="display:none">
    <div class="modal-content">
      <div class="modal-success-icon">‚úì</div>
      <h2>–£—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–π–¥–µ–Ω!</h2>
      <p id="successMessage"></p>
      <div class="modal-actions">
        <a href="index.html" class="btn btn-primary">–ö —É—Ä–æ–≤–Ω—è–º</a>
        <a href="progress.html" class="btn btn-secondary">–ü—Ä–æ–≥—Ä–µ—Å—Å</a>
      </div>
    </div>
  </div>

  <!-- Mini Python interpreter (built-in, no external deps) -->
  <script src="js/mini-python.js"></script>
  <!-- CodeMirror -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/python/python.min.js"></script>
  <!-- Game modules -->
  <script src="js/levels.js"></script>
  <script src="js/progress.js"></script>
  <script src="js/world.js"></script>
  <script src="js/crane.js"></script>
  <script src="js/camera-controls.js"></script>
  <script src="js/skulpt-runner.js"></script>
  <script src="js/checker.js"></script>
  <script src="js/editor.js"></script>
  <script src="js/game-init.js"></script>
</body>
</html>
